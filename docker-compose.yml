version: '3.5'
services:
  nginx:
    image: nginx:1.19.9-alpine
    container_name: drugstore_nginx
    volumes:
      - ./nginx/conf:/etc/nginx/conf.d
      - ./angular/build:/var/www/html
    ports:
      - '80:80'
    command: /bin/sh -c "nginx -g 'daemon off;'"
    depends_on:
      - micronaut

  redis:
    image: redis:alpine
    container_name: drugstore_redis
    ports:
      - '6379:6379'

  micronaut:
    build: ./micronaut/
    container_name: drugstore_micronaut
    environment:
      - MICRONAUT_ENVIRONMENTS=
      - REDI_URI=drugstore_redis
    ports:
      - '8080:8080'
  angular:
    build: ./angular/
    container_name: drugstore_angular
    volumes:
      - ./angular/build:/usr/src/app/dist
